# Linux 常用命令

1. **ls：**
   1. -F 表示文件类型的标识符， * 代表可执行权限的普通文件，/ 代表目录 @ 代表符号链接 | 代表命令管道 = 标识套接字 普通文件没有任何的标识
   2. -b 输出不可输出的字符 用\加字符的方式输出
   3. -t 可以按照修改时间倒序排序
   4. -m 逗号分隔对应的文件
   5. -R 递归显示子目录的文件
2. rm
   1. -d 直接把要删除的目录的硬链接数目删除成0然后删除该目录
   2. -f 强制删除目录或者文件
   3. -r 递归处理
   4. -i 删除以前询问用户
   5. -v 显示执行过程 rm -r * 删除所有的文件和子目录除了隐藏文件以外
3. Rmdir 
   1. -p 如果删除该目录以后上层目录变空了，就一起删除上级目录
4. top
   1. -b 批处理的模式操作
   2. -c 显示完成的命令
   3. -d 屏幕刷新间隔时间 单位是秒



# 分布式锁

1. Redis的setNx 和 redlock 的 使用多个Redis实例保证单点故障的可用。就是在N个实例上使用setnx 保证超过一半的情况下获得到锁。就可以了。如果获取失败就释放所有的锁。缺点是没有办法在超时以后续命，需要客户端自己控制。而且客户端死亡以后必须超时才能被别的获取。
2. 在临时目录下创建临时而且有序的节点，如果自己是最小的就获得锁了。如果不是就监控前一个节点一直到节点变更通知自己获取到锁了。优点是：自动续命，不必等待超时，一旦上一个节点死亡自己就会获取到锁。有可能两个认为自己有分布式锁。





# 分布式事务的种类问题

1. 两阶段提交
   1. 缺点：管理者有严重的单点问题。如果只有部分的参与者获取到了commit 就会导致数据不一致。而且是一个同步阻塞的操作
2. 三阶段提交 cancommit precommit docommit 
   1. 前两个阶段只要有一个参与者返回NO就停止事务，到最后一步，以后就自动提交事务，如果超时也没有关系
   2. 依然存在数据不一致性 ，比如precommit 以后有的收到了docommit 但是其他的断开了网络就不一致了。
3. tcc 事务一致性 保证的是最终一致性
4. 本地消息表 最终一致性。
5. MQ的一致性 和本地消息表相比降低了业务系统和消息表的耦合程度